---
to: "{{configuration.embraceSQLRoot}}/context.ts"
---
/* eslint-disable @typescript-eslint/camelcase */

{{> shared-context.ts}}

// Generation starts here

// All named databases
export type AvailableDatabaseNames = 
  {{#eachInMap databases}}
  "{{@key}}" {{#if @last}};{{else}}|{{/if}}
  {{/eachInMap}}

// each SQLModule  gets a context type with parameters (if present) and results
{{#eachInMap databases}}
{{#eachInMap value.SQLModules}}
{{> resultsetMetadata value}}
{{#if value.namedParameters.length }}
{{> parametersMetadata value}}
export type {{value.contextName}}Context = 
  Context & { 
    results: {{value.contextName}}Results, 
    parameters: {{value.contextName}}Parameters
  };
{{else}}
export type {{value.contextName}}Context = 
  Context & { results: {{value.contextName}}Results};
{{/if}}
export type {{value.contextName}}BeforeHandler = 
  (context: {{value.contextName}}Context) => Promise<{{value.contextName}}Context>;
{{/eachInMap}}
{{/eachInMap}}


{{#*inline "resultsetMetadata"}}
export type {{contextName}}Results = Array<
SQLRow & {
  {{#each resultsetMetadata}}
    {{name}}: {{type}}
  {{/each}}
}
>;
{{/inline}}

{{#*inline "parametersMetadata"}}
export type {{contextName}}Parameters = 
SQLParameters & {
  {{#each namedParameters}}
    {{name}}: {{type}}
  {{/each}}
};
{{/inline}}

